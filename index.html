<!DOCTYPE html>
<html>
<head>
    <title>quake</title>
    <link rel="shortcut icon" href="INSERT QUAKE ICON HERE" type="image/png">
    <style>
      body {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        overflow: hidden;
        font-family: "Times New Roman", Times, serif;
        font-size: 24pt;
      }

      .marquee {
        width: 100%;
        position: fixed;
        top: 0;
        height: 50px;
        background-color: black;
        color: white;
        overflow: hidden;
      }

      .marquee p {
        display: inline-block;
        margin: 0;
        animation: marquee 10s linear infinite;
      }

      @keyframes marquee {
        0% { transform: translateX(100%); }
        100% { transform: translateX(-100%); }
      }
    </style>
    <script src="https://cdn.jsdelivr.net/gh/ethereum/web3.js/dist/web3.min.js"></script>
    <script src="/contractABI.js"></script>
    <script>
      let contractABI = window.contractABI;
    </script>
</head>
<body>
  <div class="marquee">
    <p>Mint your QUAKE PASS now</p>
  </div>

  <button id="mint-button">Mint QUAKE PASS</button>
  <input class="mint-input" id="mint-input"/>
  <button id="mnt-btn" onclick="mintNFT()">MINT QUAKE PASS</button>

  <script>
    let web3;
    let contract;

    async function initWeb3() {
      if (typeof window.ethereum !== 'undefined') {
        web3 = new Web3(window.ethereum);
        try {
          await window.ethereum.enable(); // Request user permission
          console.log('Web3 initialized');
          return true;
        } catch (error) {
          console.error('Error while initializing Web3:', error);
          return false;
        }
      } else {
        console.error('Web3 not available');
        return false;
      }
    }

    async function initContract() {
  // The address of your deployed contract
  // Note: You should replace this with the address of your deployed contract
  const contractAddress = '0x4772f95fc2dca4564c6ec0659cadaa068cc4578f';

  try {
    const accounts = await web3.eth.getAccounts();
    const account = accounts[0];
    console.log('Minting NFT for account:', account);

    contract = new web3.eth.Contract(contractABI, contractAddress);
    console.log('Contract initialized:', contract);

    document.getElementById('mint-button').addEventListener('click', mintNFT);
  } catch (error) {
    console.error('Error while initializing contract:', error);
  }
}

    async function mintNFT() {
      try {
        const accounts = await web3.eth.getAccounts();
        const account = accounts[0];
        console.log('Minting NFT for account:', account);

        contract.methods.mintNFT(account).send({ from: account })
          .on('transactionHash', function(hash) {
            console.log("Transaction Hash:", hash);
          })
          .on('confirmation', function(confirmationNumber, receipt) {
            console.log("Confirmation Number:", confirmationNumber);
            console.log("Receipt:", receipt);
          })
          .on('error', function(error) {
            console.error('Error while minting NFT:', error);
          });
      } catch (error) {
        console.error('Error while minting NFT:', error);
      }
    }

    async function initialize() {
      if (await initWeb3()) {
        await initContract();
      }
    }

    initialize();
  </script>
</body>
</html>
